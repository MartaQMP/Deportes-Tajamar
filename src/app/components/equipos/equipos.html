<div class="equipos-container">
  <div class="filter-panel">
    <span class="filter-label">Actividades a las que estoy inscrito:</span>
    <select
      class="custom-select-event"
      [(ngModel)]="idEventoSeleccionado"
      (change)="cambioEvento()"
    >
      @for (ins of inscripciones; track ins.id) {
        <option [value]="ins.idEvento">
          {{ ins.nombreActividad }} - {{ ins.fechaEvento | date: 'dd/MM' }}
        </option>
      }
    </select>
    @if (permisosUsuario == 'CAPITAN/ALUMNO' && esCapitanEnEvento) {
      <button class="btn-crear" (click)="formularioCrearEquipo()">
        <i class="bi bi-shield-fill-plus"></i> Crear Equipo
      </button>
    }
  </div>

  @if (idEventoSeleccionado) {
    <header class="equipos-main-header">
      <div class="header-icon-circle">
        <i class="bi bi-shield-shaded"></i>
      </div>
      <h2 style="color: var(--white)">Equipos Disponibles</h2>
    </header>

    <div class="equipos-content">
      <div class="equipos-grid">
        @for (equipo of equiposMostrados; track equipo.idEquipo) {
          <div class="team-card-fixed">
            <div class="card-team-header">
              <i
                class="bi bi-shield-shaded"
                style="font-size: 1.5rem; color: var(--primary-red)"
              ></i>
              <span class="team-name">{{ equipo.nombreEquipo }}</span>
              <span class="color-text-badge">{{ getNombreColor(equipo.idColor) }}</span>
              @if (permisosUsuario == 'CAPITAN/ALUMNO' && esCapitanEnEvento) {
                <i
                  class="bi bi-trash3-fill action-icon delete"
                  title="Eliminar equipo"
                  (click)="eliminarEquipo(equipo.idEquipo)"
                  style="margin-left: auto"
                ></i>
              }
            </div>

            <div class="card-team-body">
              <small class="text-uppercase fw-bold text-muted" style="font-size: 0.7rem"
                >Integrantes</small
              >
              <ul class="member-list-static">
                @for (miembro of equipo.idEquipo | alumnosEquipoPipe | async; track $index) {
                  <li>
                    <i class="bi bi-person-fill"></i> {{ miembro.usuario }}
                    @if (permisosUsuario == 'CAPITAN/ALUMNO' && esCapitanEnEvento) {
                      <i
                        class="bi bi-trash3-fill action-icon delete"
                        title="Editar miembros"
                        style="margin-left: auto"
                        (click)="eliminarMiembroEquipo(miembro.idMiembroEquipo)"
                      ></i>
                    }
                  </li>
                } @empty {
                  <li class="text-muted">No hay miembros</li>
                }
              </ul>
              @if (estaInscrito) {
                <button class="btn-apuntado" disabled>YA ESTAS INSCRITO</button>
              } @else {
                <button
                  class="btn-apuntarme"
                  (click)="apuntarme(equipo.idEquipo, equipo.idEventoActividad)"
                >
                  APUNTARME
                </button>
              }
            </div>
          </div>
        }
      </div>
    </div>
  }
  <div style="display: none" #guardarFormulario name="guardarFormulario">
    <div class="swal-form" #formNuevoEquipo name="formNuevoEquipo">
      <label class="form-label">Nombre del Equipo</label>
      <input class="form-control" placeholder="Ej: Los Cracks" name="nombreEquipo" #nombreEquipo />
      <br />
      <label class="form-label">Selecciona el Color</label>
      <select class="form-select" name="colorSeleccionado" #colorSeleccionado>
        <option value="">Seleccione un color...</option>
        @for (color of coloresActivos; track color.idColor) {
          <option value="{{ color.idColor }}">{{ color.nombreColor }}</option>
        }
      </select>
    </div>
  </div>
</div>
