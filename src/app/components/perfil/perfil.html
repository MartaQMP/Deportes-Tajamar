@if (usuarioLogeado && usuario) {
<div class="perfil-page">
  
  <!-- ─── HEADER DEL PERFIL ─── -->
  <header class="perfil-header">
    <div class="header-content">
      <h1 class="header-title">
        <i class="bi bi-person-circle"></i>
        Mi Perfil
      </h1>
      <span class="header-status" [class.active]="usuario.estadoUsuario" [class.inactive]="!usuario.estadoUsuario">
        <i class="bi bi-circle-fill"></i>
        {{ usuario.estadoUsuario ? 'Activo' : 'Inactivo' }}
      </span>
    </div>
  </header>

  <!-- ─── CONTENIDO PRINCIPAL ─── -->
  <main class="perfil-main">
    <div class="cards-grid">
      
      <!-- CARD: Información Personal -->
      <article class="info-card">
        <header class="card-header">
          <div class="header-icon">
            <i class="bi bi-person-lines-fill"></i>
          </div>
          <div class="header-text">
            <h2>Información Personal</h2>
            <p>Datos de tu perfil de usuario</p>
          </div>
        </header>
        <div class="card-body">
          <ul class="info-list">
            <li class="info-item">
              <div class="item-icon">
                <i class="bi bi-person"></i>
              </div>
              <div class="item-content">
                <span class="item-label">Nombre Completo</span>
                <span class="item-value">{{ usuario.nombre }} {{ usuario.apellidos }}</span>
              </div>
            </li>
            <li class="info-item">
              <div class="item-icon">
                <i class="bi bi-envelope-at"></i>
              </div>
              <div class="item-content">
                <span class="item-label">Correo Electrónico</span>
                <span class="item-value email">{{ usuario.email }}</span>
              </div>
            </li>
            <li class="info-item">
              <div class="item-icon">
                <i class="bi bi-shield-check"></i>
              </div>
              <div class="item-content">
                <span class="item-label">Rol en el Sistema</span>
                <span class="item-value role-badge">{{ usuario.role }}</span>
              </div>
            </li>
          </ul>
        </div>
      </article>

      <!-- CARD: Información Académica -->
      <article class="info-card">
        <header class="card-header academic">
          <div class="header-icon">
            <i class="bi bi-mortarboard-fill"></i>
          </div>
          <div class="header-text">
            <h2>Información Académica</h2>
            <p>Datos de tu formación actual</p>
          </div>
        </header>
        <div class="card-body">
          <ul class="info-list">
            <li class="info-item">
              <div class="item-icon">
                <i class="bi bi-book"></i>
              </div>
              <div class="item-content">
                <span class="item-label">Curso Actual</span>
                <span class="item-value">{{ usuario.curso }}</span>
              </div>
            </li>
            <li class="info-item">
              <div class="item-icon">
                <i class="bi bi-hash"></i>
              </div>
              <div class="item-content">
                <span class="item-label">ID del Curso</span>
                <span class="item-value mono">#{{ usuario.idCurso }}</span>
              </div>
            </li>
            <li class="info-item">
              <div class="item-icon">
                <i class="bi bi-fingerprint"></i>
              </div>
              <div class="item-content">
                <span class="item-label">ID de Usuario</span>
                <span class="item-value mono">#{{ usuario.idUsuario }}</span>
              </div>
            </li>
          </ul>
        </div>
      </article>

    </div>

    <!-- ─── SECCIÓN: MIS ACTIVIDADES ─── -->
    <section class="actividades-section">
      <header class="section-header">
        <div class="section-title">
          <div class="title-icon">
            <i class="bi bi-journal-text"></i>
          </div>
          <div class="title-text">
            <h2>Historial de Inscripciones</h2>
            <p>Registro de actividades en las que te has inscrito</p>
          </div>
        </div>
        <span class="actividades-count" *ngIf="actividadesUsuario">
          <i class="bi bi-calendar-check"></i>
          {{ actividadesUsuario.length }} {{ actividadesUsuario.length === 1 ? 'Inscripción' : 'Inscripciones' }}
        </span>
      </header>

      <div class="actividades-content">
        @if (actividadesUsuario && actividadesUsuario.length > 0) {
          <div class="actividades-grid">
            @for (actividad of actividadesUsuario; track actividad.id) {
              <article class="actividad-card">
                <div class="actividad-date-box">
                  <span class="day">{{ actividad.fechaEvento | date:'dd' }}</span>
                  <span class="month">{{ actividad.fechaEvento | date:'MMM' }}</span>
                </div>
                <div class="actividad-info">
                  <h4 class="actividad-nombre">{{ actividad.nombreActividad }}</h4>
                  <div class="actividad-meta">
                    <span class="meta-tag">
                      <i class="bi bi-calendar-event"></i>
                      {{ actividad.fechaEvento | date:'dd/MM/yyyy' }}
                    </span>
                    <span class="meta-tag inscripcion">
                      <i class="bi bi-clock-history"></i>
                      Inscrito: {{ actividad.fechaInscripcion | date:'dd/MM/yyyy' }}
                    </span>
                  </div>
                </div>
                <div class="actividad-badges">
                  @if (actividad.quiereSerCapitan) {
                    <span class="solicita-capitan-badge">
                      <i class="bi bi-hand-index-thumb"></i>
                      Solicita Capitán
                    </span>
                  }
                </div>
              </article>
            }
          </div>
        } @else {
          <div class="empty-actividades">
            <div class="empty-icon">
              <i class="bi bi-calendar-x"></i>
            </div>
            <h3>Sin actividades</h3>
            <p>Aún no te has inscrito en ninguna actividad deportiva</p>
          </div>
        }
      </div>
    </section>

  </main>

</div>
} @else {
<div class="perfil-page">
  <div class="loading-container">
    <div class="loading-spinner">
      <div class="spinner-ring"></div>
      <i class="bi bi-person-circle"></i>
    </div>
    <p class="loading-text">Cargando perfil...</p>
  </div>
</div>
}
